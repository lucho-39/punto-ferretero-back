{% extends "base.html" %}

{% block titulo %}
Subir Productos
{% endblock titulo %}

{% block contenido %}

<h2 class="color5">Importar productos desde archivo Excel</h2>
<div class="articulos unaColumna">
    <article>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="mensajes">
            {% for message in messages %}
            <p class="error">{{ message }}</p>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <p>Selecciona un archivo Excel (.xlsx o .xls) con los datos de los productos a importar.</p>
        <p><strong>Columnas esperadas:</strong></p>
        <ul>
            <li><strong>Proveedor</strong> (o proveedor, prov): Código del proveedor</li><br>
            <li><strong>Artículo</strong> (o Articulo, artículo, articulo, art): Código del artículo (opcional)</li><br>
            <li><strong>Código</strong> (o Codigo, código, codigo, cod): Código del producto (opcional)</li><br>
            <li><strong>Categoría</strong> (o Categoria, Cat, cat): Categoría del producto</li>
            <li>Valores posibles de ejemplo: por Unidad, por Metro, Bazar, Electricidad, Herramientas, ... (sólo uno)</li><br>
            <li><strong>Imagen</strong> (o imagen, Img, img): URL de imagen del producto (opcional)</li><br>
            <li><strong>Descripción</strong> (o Descripcion, descripción, descripcion, desc): Descripción del producto</li>
        </ul>

        <form method="POST" enctype="multipart/form-data">
            <input type="file" name="file" accept=".xlsx,.xls" required>
            <input type="submit" value="Subir Archivo">
        </form>
    </article>
    <div class="crear">
        <a href="{{ url_for('productos') }}" class="menuSPA color2">Volver a Productos</a>
    </div>
</div>

{% endblock contenido %}